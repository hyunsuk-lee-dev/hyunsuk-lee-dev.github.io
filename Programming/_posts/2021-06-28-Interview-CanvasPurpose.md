---
layout: post
title: '면접 질문 정리 5 - 캔버스의 목적'
tags: [Unity]
image : /assets/img/post/2021-06-28-Interview-CanvasPurpose/main.jpg
description: >
  블로그 포스트의 템플릿에 대한 자료입니다.
---

* toc
{:toc .large-only}
유니티에서는 UI를 그릴 때 캔버스를 사용됩니다. `Image`나 `Button`, `Text`와 같은 UI 요소들은 캔버스의 자식 오브젝트로 존재할 때만 효과가 있고, 루트나 캔버스가 아닌 다른 오브젝트의 하위에 있을 때는 화면에 그려지지 않습니다. 그렇다면 캔버스는 도대체 왜 있는 것일까요? 이 캔버스의 목적은 무엇일까요.

## 드로우 콜

그래픽스 라이브러리에서 아주 중요한 요소 중에 하나는 드로우 콜(Draw Call)입니다. 이전 [렌더 파이프라인에 관한 글](https://leehs27.github.io/programming/2021-06-11-Interview-Renderpipeline/){:target="_black"}에서도 말했듯이, 드로우 콜이란, CPU가 그래픽 API를 통해 GPU에게 렌더링을 요청하는 것을 말합니다. 드로우 콜은 한번 한번이 자원을 많이 요구하기 때문에, 그래픽스 차원에서의 최적화는 이 드로우 콜을 줄이는 것이 항상 관건입니다. 

<sub>-그래픽스 차원의 관점에서-</sub> 캔버스는 이러한 목적에 의해 사용됩니다. 유니티 UI는 캔버스 단위로 드로우 콜이 이루어집니다. 일반적이 3D 오브젝트와는 달리, 하나의 캔버스 안에 동일한 여러 이미지는 하나의 드로우 콜로 처리하기 때문에, 효율적입니다. 실제로 유니티 에디터의 게임뷰의 통계창을 통해 확인해보면 큐브가 3개일 때의 배치 값은 3인 반면, 하나의 캔버스에 소속된 이미지가 3개 일 때의 배치 값은 1인 것을 확인할 수 있습니다. 

![큐브 배치](/assets/img/post/2021-06-28-Interview-CanvasPurpose/Cube Batch.png){:.center width="600px"}

큐브 3개의 배치 값은 3입니다.
{:.figcaption}

![이미지 배치](/assets/img/post/2021-06-28-Interview-CanvasPurpose/Image Batch.png){:.center width="600px"}

반면, 이미지 3개의 배치 값은 1입니다.
{:.figcaption}

## 캔버스의 배칭

그렇다고 모든 캔버스 안에 모든 요소를 넣으면 하나의 드로우 콜이 되느냐 하면, 그것은 또 아닙니다. 동일한 스프라이트를 사용하는 이미지들끼리만 묶어서 하나의 오브젝트로 처리하기 때문입니다. 

### 프레임 디버거

유니티 UI가 몇단계를 걸쳐 그려지는지 확인하기 가장 좋은 방법은 **프레임 디버거(Frame Debugger)**를 사용하는 것입니다. 유니티 상단 메뉴에서 *[Window-Analysis-Frame Debugger]*를 누르면 아래와 같은 모습의 프레임 디버거를 확인할 수 있습니다. 

![이미지 배치](/assets/img/post/2021-06-28-Interview-CanvasPurpose/Frame Debugger.png){:.center}

프레임 디버거의 모습
{:.figcaption}

이 화면에서 좌우 화살표를 눌러가면서 각 단계마다 그려지는 화면의 모습을 확인할 수 있습니다. 

### 같은 스프라이트와 캔버스

먼저 저는 체크 스프라이트를 사용하는 이미지 3개와 Knob 스프라이트를 사용하는 이미지 3개를 각각의 캔버스에 넣었습니다. 

![이미지](/assets/img/post/2021-06-28-Interview-CanvasPurpose/Scene Set.png){:.center}

그러면 3단계에서는 Knob 이미지가, 4단계에서는 Check 이미지가 한번에 그려지는 것을 볼 수 있습니다. 

![이미지](/assets/img/post/2021-06-28-Interview-CanvasPurpose/4frame.gif){:.center}

4단계에 걸쳐 그려진다.
{:.figcaption}



### 다른 스프라이트와 캔버스

그런데 이제, Knob 이미지 하나를 기존 캔버스에서 체크 이미지들이 있는 캔버스로 옮기면 어떻게 될까요.

![이미지](/assets/img/post/2021-06-28-Interview-CanvasPurpose/Other Set.png){:.center}

기존에 4단계였던 하나의 프레임이 바로 5단계로 바뀌게 됩니다. 그리고 3단계에서 2개의 Knob 이미지를 4단계에서 나머지 하나의 Knob 이미지를 그리고, 마지막 5단계에서 체크 이미지를 그리게 됩니다.

![이미지](/assets/img/post/2021-06-28-Interview-CanvasPurpose/5frame.gif){:.center}

5단계에 걸쳐 그려진다.
{:.figcaption}

하나의 캔버스 안에 있더라도 3개의 체크 이미지는 한단계에서 그리는 반면, Knob 이미지 하나는 별개의 단계를 통해 그리게 되는 것을 확인할 수 있습니다. 

그러니깐 드로우 콜을 줄이겠다고 무작정 하나의 캔버스에 모든 것을 넣는다고 반드시 성능의 이점을 기대할 수 있는 것은 아닙니다.

[동적인 처리를 할 때는 오히려 더 많은 단계를 만들기도 합니다.](https://wergia.tistory.com/205){:taget="_blank"} 

대신 같은 스프라이트 <sub>-또는 동일한 스프라이트 아틀라스-</sub>를 사용한다면, 그리고 동적이 처리가 없는 정적인 요소들끼리는 하나의 캔버스로 넣어주는 것이 드로우 콜을 줄이는 최적화가 됩니다. 
반대로, 동적이 처리가 있거나, 다른 역할을 수행하는 UI 요소들은 캔버스를 잘 분리해주는 것이 더 좋은 방법이라고 말할 수 있겠습니다.


## 결론

- 그래픽스적으로, 캔버스는 여러 UI 요소들을 하나의 오브젝트로 묶는 역할을 수행한다.

- 동일한 스프라이트를 사용하는 정적 이미지는 하나의 캔버스에 넣어야 하나의 오브젝트로 한번의 드로우 콜만을 사용한다. 
- 다른 스프라이트를 사용하거나 동적인 처리가 필요한 이미지를 사용할 때는 캔버스를 분리하면 더 적은 드로우 콜로 처리할 수 있다.
- 프레임 디버거를 통해 최적화 과정을 검토 할 수 있다. 

















#### 제목 4

##### 제목 5

###### 제목6

본문들입니다. 




이미지는 아래와 같이 첨부합니다.

![이미지](/assets/img/post/New Unity.jpg){:.center}

이것은 이미지 캡션입니다.
{:.figcaption}




이미지 사이즈를 특정하고 싶다면 아래와 같이 사용합니다.

![이미지](/assets/img/post/New Unity.jpg){:.center width="200px"}



링크는 아래와 같이 넣습니다.

[링크될 텍스트]("https://google.com"){:target="_blank"}




> 인용 사용

> 인용과 강조 동시에 사용
{:.em .lead}

강조 사용
{:.lead}




아래는 수평선입니다.

---